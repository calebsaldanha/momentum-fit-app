<%- include('../partials/header') %>
<div class="dashboard-container">
    <%- include('../partials/sidebar', { path: '/admin/users' }) %>
    <main class="dashboard-main">
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
            <div>
                <a href="/admin/users" class="btn btn-outline btn-sm" style="margin-bottom: 10px;"><i class="fas fa-arrow-left"></i> Voltar</a>
                <h1><span class="text-neon"><%= targetUser.name %></span></h1>
                <p style="color: #888;"><%= targetUser.email %> | ID: <%= targetUser.id %></p>
            </div>
            <div>
                <span class="badge-status" style="
                    padding: 6px 12px; border-radius: 20px; font-weight: bold; font-size: 0.9rem;
                    background: <%= targetUser.status === 'active' ? 'rgba(16,185,129,0.2)' : 'rgba(239,68,68,0.2)' %>;
                    color: <%= targetUser.status === 'active' ? '#10b981' : '#ef4444' %>;">
                    <%= targetUser.status.toUpperCase() %>
                </span>
            </div>
        </div>

        <div class="financial-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
            
            <div class="card-box">
                <h3 style="color: white; margin-bottom: 15px;">Ficha Técnica</h3>
                <% if (clientData && clientData.id) { %>
                    <p style="color:#ccc;"><strong>Idade:</strong> <%= clientData.age || 'N/A' %> anos</p>
                    <p style="color:#ccc;"><strong>Peso:</strong> <%= clientData.current_weight || clientData.weight %> kg</p>
                    <p style="color:#ccc;"><strong>Objetivo:</strong> <%= clientData.goal %></p>
                    <p style="color:#ccc;"><strong>Nível:</strong> <%= clientData.training_experience %></p>
                <% } else { %>
                    <p style="color: #666;">Ficha de anamnese não preenchida.</p>
                <% } %>
            </div>

            <div class="card-box">
                <h3 style="color: white; margin-bottom: 15px;">Histórico Financeiro</h3>
                <div class="table-responsive">
                    <table style="width: 100%;">
                        <thead>
                            <tr><th>Plano</th><th>Início</th><th>Status</th></tr>
                        </thead>
                        <tbody>
                            <% if (history && history.length > 0) { %>
                                <% history.forEach(sub => { %>
                                    <tr style="border-bottom: 1px solid #333;">
                                        <td><%= sub.plan_name %></td>
                                        <td><%= new Date(sub.start_date).toLocaleDateString() %></td>
                                        <td><%= sub.status %></td>
                                    </tr>
                                <% }) %>
                            <% } else { %>
                                <tr><td colspan="3" style="text-align: center;">Sem histórico.</td></tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </main>
</div>
<%- include('../partials/footer') %>
