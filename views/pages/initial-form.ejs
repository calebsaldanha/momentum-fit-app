<%- include('../partials/header', { title: 'Avaliação Inicial', bodyClass: 'auth-body' }) %>

<div class="container" style="padding: 4rem 1rem; max-width: 800px;">
    <div class="auth-card" style="max-width: 100%; text-align: left;">
        <h2 style="text-align: center; color: var(--c-accent-primary); margin-bottom: 2rem;">Avaliação Inicial</h2>
        <p style="text-align: center; margin-bottom: 2rem;">Preencha com atenção para montarmos o melhor plano para você.</p>

        <% if (error) { %>
            <div class="alert alert-danger"><%= error %></div>
        <% } %>

        <form action="/client/initial-form" method="POST">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">

            <h4 style="color: var(--c-text-primary); border-bottom: 1px solid var(--c-border); padding-bottom: 0.5rem; margin-top: 2rem;">Dados Pessoais</h4>
            
            <div class="form-group">
                <label>Nome Completo</label>
                <input type="text" value="<%= user.name %>" readonly style="opacity: 0.7; cursor: not-allowed;">
            </div>

            <div class="form-group">
                <label>E-mail</label>
                <input type="email" value="<%= user.email %>" readonly style="opacity: 0.7; cursor: not-allowed;">
            </div>

            <div class="row" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div class="form-group" style="flex: 1;">
                    <label>Idade</label>
                    <input type="number" name="age" required>
                </div>
                <div class="form-group" style="flex: 1;">
                    <label>Telefone / WhatsApp</label>
                    <input type="text" name="phone" required placeholder="(00) 00000-0000">
                </div>
            </div>

            <div class="row" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div class="form-group" style="flex: 1;">
                    <label>Identidade de Gênero</label>
                    <select name="gender_identity">
                        <option value="masculino">Masculino</option>
                        <option value="feminino">Feminino</option>
                        <option value="nao_binario">Não-binário</option>
                        <option value="outro">Outro</option>
                        <option value="prefiro_nao_dizer">Prefiro não dizer</option>
                    </select>
                </div>
                <div class="form-group" style="flex: 1;">
                    <label>Sexo Atribuído no Nascimento</label>
                    <select name="sex_assigned_at_birth">
                        <option value="masculino">Masculino</option>
                        <option value="feminino">Feminino</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label>Está em transição ou tratamento hormonal?</label>
                <select name="hormonal_treatment" id="hormonalDetailsToggle">
                    <option value="false">Não</option>
                    <option value="true">Sim</option>
                </select>
            </div>
            <div class="form-group" id="hormonalDetailsBox" style="display: none;">
                <label>Comente sobre o processo (tempo, medicamentos, etc)</label>
                <textarea name="hormonal_details" rows="2"></textarea>
            </div>

            <h4 style="color: var(--c-text-primary); border-bottom: 1px solid var(--c-border); padding-bottom: 0.5rem; margin-top: 2rem;">Objetivos</h4>

            <div class="form-group">
                <label>Objetivo Principal</label>
                <textarea name="main_goal" rows="2" required placeholder="Ex: Emagrecer 5kg, ganhar massa muscular..."></textarea>
            </div>

            <div class="form-group">
                <label>Objetivos Secundários</label>
                <textarea name="secondary_goals" rows="2" placeholder="Ex: Melhorar sono, diminuir estresse..."></textarea>
            </div>

            <div class="form-group">
                <label>Data ou Evento Específico (Deadline)?</label>
                <input type="text" name="specific_event" placeholder="Ex: Casamento em dezembro, Verão...">
            </div>

            <h4 style="color: var(--c-text-primary); border-bottom: 1px solid var(--c-border); padding-bottom: 0.5rem; margin-top: 2rem;">Saúde & Histórico</h4>

            <div class="form-group">
                <label>Condições Médicas Relevantes</label>
                <textarea name="medical_conditions" rows="2" placeholder="Diabetes, Hipertensão, Labirintite..."></textarea>
            </div>

            <div class="form-group">
                <label>Medicamentos em uso</label>
                <textarea name="medications" rows="2"></textarea>
            </div>

            <div class="form-group">
                <label>Cirurgias Realizadas</label>
                <textarea name="surgeries" rows="2"></textarea>
            </div>

            <div class="form-group">
                <label>Lesões Passadas ou Atuais</label>
                <textarea name="injuries" rows="2" placeholder="Joelho, Ombro, Coluna..."></textarea>
            </div>

            <div class="form-group">
                <label>Alergias ou Restrições Alimentares</label>
                <textarea name="allergies" rows="2"></textarea>
            </div>

            <h4 style="color: var(--c-text-primary); border-bottom: 1px solid var(--c-border); padding-bottom: 0.5rem; margin-top: 2rem;">Estilo de Vida</h4>

            <div class="form-group">
                <label>Nível de Atividade Física Atual</label>
                <select name="fitness_level">
                    <option value="sedentario">Sedentário (Não pratico nada)</option>
                    <option value="iniciante">Iniciante (1-2x semana)</option>
                    <option value="intermediario">Intermediário (3-4x semana)</option>
                    <option value="avancado">Avançado (5x+ semana)</option>
                </select>
            </div>

            <div class="form-group">
                <label>Experiência com Atividades Físicas (O que já praticou?)</label>
                <textarea name="past_activity" rows="2"></textarea>
            </div>

            <div class="form-group">
                <label>Atividades que MAIS gosta</label>
                <textarea name="liked_activities" rows="2" placeholder="Musculação, Corrida, Yoga..."></textarea>
            </div>

            <div class="form-group">
                <label>Atividades que NÃO gosta / Evita</label>
                <textarea name="disliked_activities" rows="2"></textarea>
            </div>

            <div class="form-group">
                <label>Preferência de Treino</label>
                <select name="workout_preference">
                    <option value="academia">Academia</option>
                    <option value="casa">Em Casa</option>
                    <option value="hibrido">Híbrido / Ambos</option>
                </select>
            </div>

            <div class="form-group">
                <label>Disponibilidade Semanal (Dias e Horários)</label>
                <textarea name="availability" rows="2" placeholder="Seg-Sex às 18h, Sáb pela manhã..."></textarea>
            </div>

            <div class="form-group">
                <label>Maiores Desafios</label>
                <textarea name="challenges" rows="2" placeholder="Falta de tempo, preguiça, ansiedade..."></textarea>
            </div>

            <div class="form-group">
                <label>Alimentação Atual (Descreva brevemente)</label>
                <textarea name="diet_description" rows="3"></textarea>
            </div>

            <div class="form-group">
                <label>Horas de sono por noite (Média)</label>
                <input type="text" name="sleep_hours" placeholder="Ex: 6-7 horas">
            </div>

            <h4 style="color: var(--c-text-primary); border-bottom: 1px solid var(--c-border); padding-bottom: 0.5rem; margin-top: 2rem;">Medidas Corporais</h4>

            <div class="row" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div class="form-group" style="flex: 1;">
                    <label>Peso (kg)</label>
                    <input type="number" step="0.1" name="weight" required>
                </div>
                <div class="form-group" style="flex: 1;">
                    <label>Altura (m)</label>
                    <input type="number" step="0.01" name="height" placeholder="Ex: 1.75" required>
                </div>
            </div>

            <div class="row" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div class="form-group" style="flex: 1;">
                    <label>Cintura (cm)</label>
                    <input type="number" step="0.1" name="measure_waist">
                </div>
                <div class="form-group" style="flex: 1;">
                    <label>Quadril (cm)</label>
                    <input type="number" step="0.1" name="measure_hip">
                </div>
            </div>

            <div class="row" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div class="form-group" style="flex: 1;">
                    <label>Braço (cm)</label>
                    <input type="number" step="0.1" name="measure_arm" placeholder="Relaxado">
                </div>
                <div class="form-group" style="flex: 1;">
                    <label>Perna/Coxa (cm)</label>
                    <input type="number" step="0.1" name="measure_leg">
                </div>
            </div>

            <div class="form-group">
                <label>Percentual de Gordura (%) - Opcional</label>
                <input type="number" step="0.1" name="body_fat">
            </div>

            <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">Enviar Avaliação</button>
        </form>
    </div>
</div>

<script>
    document.getElementById('hormonalDetailsToggle').addEventListener('change', function() {
        const box = document.getElementById('hormonalDetailsBox');
        if (this.value === 'true') {
            box.style.display = 'block';
        } else {
            box.style.display = 'none';
        }
    });
</script>

<%- include('../partials/footer') %>
