<%- include('../partials/header.ejs', { title: 'Avaliação Inicial', currentPage: 'initial-form' }) %>

<div class="dashboard-container">
    <%- include('../partials/sidebar.ejs') %>

    <main class="dashboard-main">
        <div class="text-center" style="margin-bottom: 2rem;">
            <h1 class="text-neon">Anamnese Completa</h1>
            <p class="text-muted">Preencha com atenção. Essas informações guiarão seu treinador.</p>
        </div>

        <% if (typeof error !== 'undefined' && error) { %>
            <div class="alert alert-error" style="background: rgba(239,68,68,0.2); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; color: #fca5a5;">
                <%= error %>
            </div>
        <% } %>

        <form action="/client/initial-form" method="POST">
            <input type="hidden" name="_csrf" value="<%= typeof csrfToken !== 'undefined' ? csrfToken : '' %>">

            <div class="card-modern">
                <h3 class="text-neon" style="margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem;">1. Dados Pessoais</h3>
                <div class="grid-cols-2">
                    <div class="form-group"><label class="form-label">Idade</label><input type="number" name="age" class="input-modern" required value="<%= profile?.age || '' %>"></div>
                    <div class="form-group"><label class="form-label">WhatsApp</label><input type="text" name="phone" class="input-modern" required value="<%= profile?.phone || '' %>"></div>
                    <div class="form-group"><label class="form-label">Profissão</label><input type="text" name="profession" class="input-modern" placeholder="Ex: Programador (passo o dia sentado)" value="<%= profile?.profession || '' %>"></div>
                    <div class="form-group">
                        <label class="form-label">Sexo Biológico</label>
                        <select name="sex_assigned_at_birth" class="select-modern" required>
                            <option value="M" <%= profile?.sex_assigned_at_birth === 'M' ? 'selected' : '' %>>Masculino</option>
                            <option value="F" <%= profile?.sex_assigned_at_birth === 'F' ? 'selected' : '' %>>Feminino</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="card-modern">
                <h3 class="text-neon" style="margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem;">2. Medidas Atuais</h3>
                <div class="grid-cols-3">
                    <div class="form-group"><label class="form-label">Peso (kg) *</label><input type="number" step="0.1" name="weight" class="input-modern" required value="<%= profile?.current_weight || profile?.weight || '' %>"></div>
                    <div class="form-group"><label class="form-label">Altura (m) *</label><input type="number" step="0.01" name="height" class="input-modern" required value="<%= profile?.height || '' %>"></div>
                    <div class="form-group"><label class="form-label">% Gordura (Opcional)</label><input type="number" step="0.1" name="body_fat" class="input-modern" value="<%= profile?.body_fat || '' %>"></div>
                </div>
                <div class="grid-cols-3">
                    <div class="form-group"><label class="form-label">Cintura (cm)</label><input type="number" name="measure_waist" class="input-modern" value="<%= profile?.measure_waist || '' %>"></div>
                    <div class="form-group"><label class="form-label">Quadril (cm)</label><input type="number" name="measure_hip" class="input-modern" value="<%= profile?.measure_hip || '' %>"></div>
                    <div class="form-group"><label class="form-label">Braço (cm)</label><input type="number" name="measure_arm" class="input-modern" value="<%= profile?.measure_arm || '' %>"></div>
                </div>
            </div>

            <div class="card-modern">
                <h3 class="text-neon" style="margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem;">3. Saúde & Estilo de Vida</h3>
                
                <div class="grid-cols-2">
                    <div class="form-group">
                        <label class="form-label">Horas de sono por noite?</label>
                        <input type="text" name="sleep_hours" class="input-modern" placeholder="Ex: 6h, acordo cansado" value="<%= profile?.sleep_hours || '' %>">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Nível de Estresse (1-10)</label>
                        <select name="stress_level" class="select-modern">
                            <option value="low">Baixo</option>
                            <option value="medium">Médio</option>
                            <option value="high">Alto</option>
                        </select>
                    </div>
                </div>

                <div class="grid-cols-2">
                    <div class="form-group">
                        <label class="form-label">Consumo de Água (Litros/dia)</label>
                        <input type="text" name="water_intake" class="input-modern" placeholder="Ex: 2 Litros" value="<%= profile?.water_intake || '' %>">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Fumante ou Bebe Álcool?</label>
                        <input type="text" name="habits" class="input-modern" placeholder="Ex: Socialmente aos finais de semana" value="<%= profile?.habits || '' %>">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Como é sua alimentação hoje?</label>
                    <textarea name="diet_description" class="textarea-modern" rows="3" placeholder="Quantas refeições? O que costuma comer? Restrições?"><%= profile?.diet_description || '' %></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">Lesões, dores ou problemas de saúde?</label>
                    <textarea name="injuries" class="textarea-modern" rows="2" placeholder="Joelho, coluna, hipertensão, diabetes..."><%= profile?.injuries || '' %></textarea>
                </div>
            </div>

            <div class="card-modern">
                <h3 class="text-neon" style="margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem;">4. Planejamento de Treino</h3>
                
                <div class="form-group">
                    <label class="form-label">Objetivo Principal *</label>
                    <input type="text" name="main_goal" class="input-modern" required placeholder="Ex: Emagrecer 5kg, Ganhar massa muscular" value="<%= profile?.fitness_goals || profile?.main_goal || '' %>">
                </div>

                <div class="grid-cols-2">
                    <div class="form-group">
                        <label class="form-label">Experiência</label>
                        <select name="fitness_level" class="select-modern" required>
                            <option value="beginner" <%= profile?.fitness_level === 'beginner' ? 'selected' : '' %>>Iniciante</option>
                            <option value="intermediate" <%= profile?.fitness_level === 'intermediate' ? 'selected' : '' %>>Intermediário</option>
                            <option value="advanced" <%= profile?.fitness_level === 'advanced' ? 'selected' : '' %>>Avançado</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Dias disponíveis p/ treinar</label>
                        <select name="training_days" class="select-modern" required>
                            <option value="2">2 dias</option>
                            <option value="3" <%= profile?.training_days_frequency == 3 ? 'selected' : '' %>>3 dias</option>
                            <option value="4" <%= profile?.training_days_frequency == 4 ? 'selected' : '' %>>4 dias</option>
                            <option value="5" <%= profile?.training_days_frequency == 5 ? 'selected' : '' %>>5 dias</option>
                            <option value="6" <%= profile?.training_days_frequency == 6 ? 'selected' : '' %>>6 dias</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Onde vai treinar? Equipamentos?</label>
                    <input type="text" name="equipment" class="input-modern" placeholder="Academia SmartFit, Em casa com halteres..." value="<%= profile?.equipment || '' %>">
                </div>
            </div>

            <button type="submit" class="btn btn-primary btn-full" style="padding: 1rem; font-size: 1.1rem; margin-bottom: 3rem;">
                SALVAR E ENVIAR AO TREINADOR
            </button>
        </form>
    </main>
</div>
<%- include('../partials/footer.ejs') %>
