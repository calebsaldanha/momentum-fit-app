<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <%- include('../layouts/app/head') %>
    <title>AI Coach | Momentum</title>
</head>
<body>
    <div class="dashboard-wrapper">
        <%- include('../partials/sidebar') %>
        
        <div class="main-content" style="height: 100dvh; display: flex; flex-direction: column;">
            <%- include('../partials/app-header', { title: 'Momentum Intelligence' }) %>

            <div style="flex: 1; display: flex; flex-direction: column; overflow: hidden; max-width: 1000px; margin: 0 auto; width: 100%; padding: 20px;">
                
                <div class="card" style="flex: 1; display: flex; flex-direction: column; padding: 0; overflow: hidden; margin-bottom: 0;">
                    
                    <div style="flex: 1; overflow-y: auto; padding: 30px; display: flex; flex-direction: column; gap: 20px;">
                        
                        <% if (messages && messages.length > 0) { %>
                            <% messages.forEach(msg => { %>
                                <div style="align-self: <%= msg.sender === 'user' ? 'flex-end' : 'flex-start' %>; max-width: 80%;">
                                    <div style="<%= msg.sender === 'user' ? 'background: var(--primary); color: black;' : 'background: rgba(255,255,255,0.05); color: white; border: 1px solid #333;' %> padding: 15px 20px; border-radius: 12px;">
                                        <p style="margin: 0;"><%= msg.text %></p>
                                    </div>
                                </div>
                            <% }) %>
                        <% } else { %>
                            <div class="ai-empty">
                                <div class="ai-icon-bg"><i class="fas fa-brain"></i></div>
                                <h3 style="color: white; margin-bottom: 10px;">Coach IA Pronto</h3>
                                <p>Estou conectado aos seus dados de treino. Pergunte-me sobre sua evolução, peça ajustes de carga ou dicas de dieta.</p>
                            </div>
                        <% } %>

                    </div>

                    <div style="padding: 20px; background: #111; border-top: 1px solid #222;">
                        <form action="/api/chat" method="POST" style="display: flex; gap: 10px;">
                            <input type="text" name="message" class="form-control" placeholder="Ex: Analise meu último treino de pernas..." style="margin-bottom: 0; background: #050505;">
                            <button type="submit" class="btn btn-primary" style="width: 50px; padding: 0;"><i class="fas fa-paper-plane"></i></button>
                        </form>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <script src="/js/layout.js"></script>
</body>
</html>
