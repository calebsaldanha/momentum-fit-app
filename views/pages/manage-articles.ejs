<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <%- include('../partials/header') %>
    <link rel="stylesheet" href="/css/dashboard.css">
    <style>
        .article-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem; }
        .article-card-img { height: 160px; width: 100%; object-fit: cover; border-bottom: 1px solid var(--border-subtle); }
        .article-content { padding: 1.5rem; }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <%- include('../partials/sidebar', { user: user, currentPage: 'articles-manage' }) %>

        <main class="dashboard-main">
            <header class="page-header">
                <div>
                    <h1>Gerenciar Artigos</h1>
                    <p>Conte√∫do educativo para a comunidade.</p>
                </div>
                <a href="/articles/create" class="btn btn-primary"><i class="fas fa-plus"></i> Escrever Artigo</a>
            </header>

            <% if (!articles || articles.length === 0) { %>
                <div class="card-modern text-center py-5">
                    <p class="text-muted">Nenhum artigo publicado ainda.</p>
                </div>
            <% } else { %>
                <div class="article-grid">
                    <% articles.forEach(article => { %>
                        <div class="card-modern p-0 overflow-hidden d-flex flex-column">
                            <img src="<%= article.image_url || '/images/hero-bg.png' %>" class="article-card-img">
                            <div class="article-content flex-grow-1">
                                <div class="d-flex justify-content-between mb-2">
                                    <span class="badge badge-<%= article.status === 'published' ? 'active' : 'inactive' %>">
                                        <%= article.status === 'published' ? 'Publicado' : 'Pendente' %>
                                    </span>
                                    <small class="text-muted"><%= new Date(article.created_at).toLocaleDateString() %></small>
                                </div>
                                <h3 class="h5 mb-3 text-truncate"><%= article.title %></h3>
                                <div class="d-flex gap-2 mt-auto">
                                    <a href="/articles/edit/<%= article.id %>" class="btn btn-ghost btn-sm w-100">Editar</a>
                                    <form action="/articles/delete/<%= article.id %>" method="POST" class="w-100" onsubmit="return confirm('Excluir?');">
                                        <button class="btn btn-danger btn-sm w-100"><i class="fas fa-trash"></i></button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    <% }) %>
                </div>
            <% } %>
        </main>
    </div>
</body>
</html>
