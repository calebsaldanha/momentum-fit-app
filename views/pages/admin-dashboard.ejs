<%- include('../partials/header.ejs') %>
<div class="dashboard-container">
    <%- include('../partials/sidebar.ejs', { path: '/admin/dashboard' }) %>
    <main class="dashboard-main">
        <div class="page-header">
            <h1>Painel <span class="text-neon">Geral</span></h1>
            <p>Métricas e desempenho do sistema.</p>
        </div>

        <div class="dashboard-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 30px;">
            <div class="stat-card" style="background: #222; padding: 20px; border-radius: 10px; border-left: 4px solid #bef202; display: flex; align-items: center; gap: 15px;">
                <div class="icon" style="font-size: 2rem; color: #bef202;"><i class="fas fa-users"></i></div>
                <div>
                    <h3 style="margin: 0; font-size: 1.8rem; color: white;"><%= stats.clients %></h3>
                    <p style="margin: 0; color: #888; font-size: 0.9rem;">Alunos Totais</p>
                </div>
            </div>
            
            <div class="stat-card" style="background: #222; padding: 20px; border-radius: 10px; border-left: 4px solid #4da6ff; display: flex; align-items: center; gap: 15px;">
                <div class="icon" style="font-size: 2rem; color: #4da6ff;"><i class="fas fa-chalkboard-teacher"></i></div>
                <div>
                    <h3 style="margin: 0; font-size: 1.8rem; color: white;"><%= stats.trainers %></h3>
                    <p style="margin: 0; color: #888; font-size: 0.9rem;">Treinadores</p>
                </div>
            </div>

            <div class="stat-card" style="background: #222; padding: 20px; border-radius: 10px; border-left: 4px solid #ff4d4d; display: flex; align-items: center; gap: 15px;">
                <div class="icon" style="font-size: 2rem; color: #ff4d4d;"><i class="fas fa-dollar-sign"></i></div>
                <div>
                    <h3 style="margin: 0; font-size: 1.8rem; color: white;">R$ <%= parseFloat(stats.revenue).toFixed(0) %></h3>
                    <p style="margin: 0; color: #888; font-size: 0.9rem;">Receita (30d)</p>
                </div>
            </div>

            <div class="stat-card" style="background: #222; padding: 20px; border-radius: 10px; border-left: 4px solid orange; display: flex; align-items: center; gap: 15px;">
                <div class="icon" style="font-size: 2rem; color: orange;"><i class="fas fa-clock"></i></div>
                <div>
                    <h3 style="margin: 0; font-size: 1.8rem; color: white;"><%= stats.pending %></h3>
                    <p style="margin: 0; color: #888; font-size: 0.9rem;">Pendências Fin.</p>
                </div>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px;">
            <div class="card-box">
                <h3 style="color: white; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px;">
                    Novos Cadastros
                </h3>
                <div class="table-responsive">
                    <table style="width: 100%; text-align: left; border-collapse: collapse;">
                        <thead>
                            <tr style="color: #888;">
                                <th style="padding: 10px;">Nome</th>
                                <th style="padding: 10px;">Tipo</th>
                                <th style="padding: 10px;">Data</th>
                                <th style="padding: 10px;">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if (recentUsers && recentUsers.length > 0) { %>
                                <% recentUsers.forEach(u => { %>
                                    <tr style="border-bottom: 1px solid #333;">
                                        <td style="padding: 10px; color: white;"><%= u.name %></td>
                                        <td style="padding: 10px;">
                                            <span style="font-size:0.8rem; padding: 2px 6px; border-radius: 4px; background: <%= u.role === 'client' ? '#333' : '#4da6ff22' %>; color: <%= u.role === 'client' ? '#ccc' : '#4da6ff' %>">
                                                <%= u.role === 'client' ? 'Aluno' : 'Trainer' %>
                                            </span>
                                        </td>
                                        <td style="padding: 10px; color: #ccc;"><%= new Date(u.created_at).toLocaleDateString() %></td>
                                        <td style="padding: 10px;">
                                            <span style="color: <%= u.status === 'active' ? '#bef202' : 'orange' %>">• <%= u.status %></span>
                                        </td>
                                    </tr>
                                <% }) %>
                            <% } else { %>
                                <tr><td colspan="4" style="padding:20px; text-align:center; color:#666;">Sem novos usuários.</td></tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card-box">
                <h3 style="color: white; margin-bottom: 20px;">Atalhos</h3>
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <a href="/admin/users" class="btn btn-outline" style="text-align: center; justify-content:center;">
                        <i class="fas fa-users"></i> &nbsp; Gerenciar Usuários
                    </a>
                    <a href="/admin/finance" class="btn btn-outline" style="text-align: center; justify-content:center; border-color: orange; color: orange;">
                        <i class="fas fa-wallet"></i> &nbsp; Aprovar Pagamentos
                    </a>
                    <a href="/admin/content" class="btn btn-outline" style="text-align: center; justify-content:center;">
                        <i class="fas fa-newspaper"></i> &nbsp; Publicar Conteúdo
                    </a>
                </div>
            </div>
        </div>
    </main>
</div>
<%- include('../partials/footer.ejs') %>
