<%- include('../partials/header') %>

<div class="page-content-wrapper">
    <div style="max-width: 900px; margin: 0 auto;">
        
        <div style="display: flex; align-items: center; gap: 1.5rem; margin-bottom: 2rem;">
            <div style="width: 80px; height: 80px; background: var(--primary); color: black; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: bold;">
                <%= user.name.charAt(0).toUpperCase() %>
            </div>
            <div>
                <h2 class="text-neon" style="margin: 0;"><%= user.name %></h2>
                <p class="text-muted" style="margin: 5px 0 0 0;"><%= user.email %></p>
                <span class="badge" style="background: var(--bg-hover); padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; margin-top: 8px; display: inline-block;">Aluno</span>
            </div>
        </div>

        <form action="/client/profile/update" method="POST" class="card-modern">
            <input type="hidden" name="_csrf" value="<%= typeof csrfToken !== 'undefined' ? csrfToken : '' %>">
            
            <div class="form-section-header"><h3><i class="fas fa-user-edit"></i> Dados Pessoais</h3></div>
            <div class="form-group">
                <label class="form-label">Nome Completo</label>
                <input type="text" name="name" value="<%= user.name %>" class="form-input">
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1rem;">
                <div class="form-group">
                    <label class="form-label">Data de Nascimento</label>
                    <input type="date" name="birthDate" value="<%= clientData.birth_date ? new Date(clientData.birth_date).toISOString().split('T')[0] : '' %>" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Gênero</label>
                    <select name="gender" class="form-input">
                        <option value="male" <%= clientData.sex_assigned_at_birth === 'male' ? 'selected' : '' %>>Masculino</option>
                        <option value="female" <%= clientData.sex_assigned_at_birth === 'female' ? 'selected' : '' %>>Feminino</option>
                        <option value="other" <%= clientData.sex_assigned_at_birth === 'other' ? 'selected' : '' %>>Outro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Peso (kg)</label>
                    <input type="number" step="0.1" name="weight" value="<%= clientData.current_weight %>" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Altura (cm)</label>
                    <input type="number" name="height" value="<%= clientData.height %>" class="form-input">
                </div>
            </div>

            <hr style="border: 0; border-top: 1px solid var(--border); margin: 2rem 0;">

            <div class="form-section-header"><h3><i class="fas fa-bullseye"></i> Objetivos</h3></div>
            <div class="form-group">
                <label class="form-label">Objetivo Principal</label>
                <select name="primaryGoal" class="form-input">
                    <option value="weight_loss" <%= clientData.fitness_goals === 'weight_loss' ? 'selected' : '' %>>Emagrecimento</option>
                    <option value="hypertrophy" <%= clientData.fitness_goals === 'hypertrophy' ? 'selected' : '' %>>Hipertrofia</option>
                    <option value="strength" <%= clientData.fitness_goals === 'strength' ? 'selected' : '' %>>Força Pura</option>
                    <option value="conditioning" <%= clientData.fitness_goals === 'conditioning' ? 'selected' : '' %>>Condicionamento</option>
                    <option value="health" <%= clientData.fitness_goals === 'health' ? 'selected' : '' %>>Saúde</option>
                    <option value="rehabilitation" <%= clientData.fitness_goals === 'rehabilitation' ? 'selected' : '' %>>Reabilitação</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Prazo / Meta Específica</label>
                <input type="text" name="goalDeadline" class="form-input" value="<%= clientData.goal_deadline || '' %>">
            </div>
            <div class="form-group">
                <label class="form-label">Foco Muscular</label>
                <input type="text" name="focusArea" class="form-input" value="<%= clientData.focus_area || '' %>">
            </div>

            <hr style="border: 0; border-top: 1px solid var(--border); margin: 2rem 0;">

            <div class="form-section-header"><h3><i class="fas fa-heartbeat"></i> Saúde</h3></div>
            <div class="form-group">
                <label class="form-label">Lesões e Dores</label>
                <input type="text" name="injuries" class="form-input" value="<%= clientData.injuries || '' %>" placeholder="Descreva lesões ou dores...">
            </div>
            <div class="form-group">
                <label class="form-label">Medicamentos</label>
                <input type="text" name="medications" class="form-input" value="<%= clientData.medications || '' %>">
            </div>

            <hr style="border: 0; border-top: 1px solid var(--border); margin: 2rem 0;">

            <div class="form-section-header"><h3><i class="fas fa-coffee"></i> Rotina</h3></div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                <div class="form-group">
                    <label class="form-label">Profissão</label>
                    <select name="occupationType" class="form-input">
                        <option value="sedentary" <%= clientData.occupation === 'sedentary' ? 'selected' : '' %>>Sedentário</option>
                        <option value="light" <%= clientData.occupation === 'light' ? 'selected' : '' %>>Leve</option>
                        <option value="moderate" <%= clientData.occupation === 'moderate' ? 'selected' : '' %>>Moderado</option>
                        <option value="heavy" <%= clientData.occupation === 'heavy' ? 'selected' : '' %>>Pesado</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Horas de Sono</label>
                    <input type="number" name="sleepHours" class="form-input" value="<%= clientData.sleep_hours %>">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Nível de Stress (1-10)</label>
                <input type="range" name="stressLevel" min="1" max="10" value="<%= clientData.stress_level || 5 %>" style="width:100%;">
            </div>
             <div class="form-group">
                <label class="form-label">Água Diária</label>
                <select name="waterIntake" class="form-input">
                    <option value="low" <%= clientData.water_intake === 'low' ? 'selected' : '' %>> < 1 Litro</option>
                    <option value="medium" <%= clientData.water_intake === 'medium' ? 'selected' : '' %>>1 - 2 Litros</option>
                    <option value="high" <%= clientData.water_intake === 'high' ? 'selected' : '' %>>2 - 3 Litros</option>
                    <option value="excellent" <%= clientData.water_intake === 'excellent' ? 'selected' : '' %>>> 3 Litros</option>
                </select>
            </div>

            <div style="margin-top: 3rem; display: flex; justify-content: flex-end;">
                <button type="submit" class="btn btn-primary" style="padding: 1rem 2rem; font-size: 1.1rem;">
                    <i class="fas fa-save"></i> Salvar Alterações
                </button>
            </div>
        </form>

        <div style="margin-top: 3rem; padding: 1.5rem; border: 1px solid rgba(239,68,68,0.3); border-radius: 12px; background: rgba(239,68,68,0.05);">
            <h4 style="color: #ef4444; margin-top: 0;">Zona de Perigo</h4>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <p class="text-muted" style="font-size: 0.9rem; margin: 0;">Deseja sair da sua conta?</p>
                <a href="/auth/logout" onclick="event.preventDefault(); document.getElementById('logout-form-header').submit();" class="btn btn-outline" style="border-color: #ef4444; color: #ef4444;">Sair da Conta</a>
            </div>
        </div>
    </div>
</div>

<%- include('../partials/footer') %>
