<%- include('../partials/header.ejs', { title: 'Meu Perfil', currentPage: 'profile' }) %>
<div class="dashboard-container">
    <%- include('../partials/sidebar.ejs', { currentPage: 'profile' }) %>

    <main class="dashboard-main">
        <div class="page-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
            <div>
                <h1 class="page-title">Meu Perfil</h1>
                <p class="text-muted">Gerencie suas informações pessoais.</p>
            </div>
            <a href="/client/initial-form" class="btn btn-primary btn-sm">
                <i class="fas fa-edit"></i> Refazer Anamnese Completa
            </a>
        </div>

        <div class="card-modern" style="margin-bottom: 2rem;">
            <div style="display: flex; align-items: center; gap: 1.5rem; margin-bottom: 2rem;">
                <div style="width: 80px; height: 80px; background: var(--bg-input); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: var(--primary);">
                    <i class="fas fa-user"></i>
                </div>
                <div>
                    <h2 style="margin: 0; font-size: 1.5rem;"><%= user.name %></h2>
                    <span style="color: var(--text-secondary);"><%= user.email %></span>
                    <div style="margin-top: 5px;">
                        <span class="text-neon" style="font-size: 0.9rem; border: 1px solid var(--primary); padding: 2px 8px; border-radius: 4px;">Aluno</span>
                    </div>
                </div>
            </div>

            <h3 class="text-muted" style="font-size: 1rem; margin-bottom: 1rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem;">Dados Físicos (Resumo)</h3>
            <div class="grid-cols-3">
                <div class="form-group">
                    <label class="form-label">Peso Atual</label>
                    <div class="input-modern" style="opacity: 0.8;"><%= profile.current_weight || '--' %> kg</div>
                </div>
                <div class="form-group">
                    <label class="form-label">Altura</label>
                    <div class="input-modern" style="opacity: 0.8;"><%= profile.height || '--' %> m</div>
                </div>
                <div class="form-group">
                    <label class="form-label">Objetivo</label>
                    <div class="input-modern" style="opacity: 0.8;"><%= profile.fitness_goals || 'Não definido' %></div>
                </div>
            </div>
        </div>

        <div class="card-modern">
            <h3 class="text-neon" style="margin-bottom: 1.5rem;">Alterar Senha</h3>
            <form action="/client/change-password" method="POST" style="max-width: 500px;">
                <input type="hidden" name="_csrf" value="<%= typeof csrfToken !== 'undefined' ? csrfToken : '' %>">
                
                <div class="form-group">
                    <label class="form-label">Senha Atual</label>
                    <input type="password" name="current_password" required class="input-modern">
                </div>
                
                <div class="grid-cols-2">
                    <div class="form-group">
                        <label class="form-label">Nova Senha</label>
                        <input type="password" name="new_password" required class="input-modern">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Confirmar Nova Senha</label>
                        <input type="password" name="confirm_password" required class="input-modern">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">Atualizar Senha</button>
            </form>
        </div>
    </main>
</div>
<%- include('../partials/footer.ejs') %>
