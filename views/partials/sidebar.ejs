<div class="mobile-dash-header">
    <a href="/" class="brand-logo" style="color:white; font-weight:800;">Momentum Fit</a>
    <button id="sidebarToggle" class="btn btn-ghost"><i class="fas fa-bars"></i></button>
</div>

<div class="sidebar-overlay" id="sidebarOverlay"></div>

<aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <a href="/" class="sidebar-logo">
            <img src="/images/momentum-fit-icon.png" alt="Logo" style="height:28px;">
            Momentum Fit
        </a>
    </div>

    <nav class="sidebar-nav">
        <% if (user.role === 'client') { %>
            <div class="menu-category">Menu Principal</div>
            <a href="/client/dashboard" class="nav-item <%= currentPage === '/client/dashboard' ? 'active' : '' %>">
                <i class="fas fa-home"></i> Visão Geral
            </a>
            <a href="/client/workouts" class="nav-item <%= currentPage.includes('/client/workouts') ? 'active' : '' %>">
                <i class="fas fa-dumbbell"></i> Meus Treinos
            </a>
            <a href="/chat" class="nav-item <%= currentPage === '/chat' ? 'active' : '' %>">
                <i class="fas fa-comments"></i> Chat IA/Personal
            </a>
            <a href="/client/evolution" class="nav-item <%= currentPage === '/client/evolution' ? 'active' : '' %>">
                <i class="fas fa-chart-line"></i> Evolução
            </a>

            <div class="menu-category">Conta</div>
            <a href="/client/profile" class="nav-item <%= currentPage === '/client/profile' ? 'active' : '' %>">
                <i class="fas fa-user-cog"></i> Meu Perfil
            </a>
            <a href="/client/plans" class="nav-item <%= currentPage === '/client/plans' ? 'active' : '' %>">
                <i class="fas fa-credit-card"></i> Planos
            </a>
        
        <% } else if (user.role === 'trainer') { %>
            <div class="menu-category">Profissional</div>
            <a href="/trainer/dashboard" class="nav-item <%= currentPage === '/trainer/dashboard' ? 'active' : '' %>">
                <i class="fas fa-tachometer-alt"></i> Painel
            </a>
            <a href="/trainer/clients" class="nav-item <%= currentPage.includes('/trainer/clients') ? 'active' : '' %>">
                <i class="fas fa-users"></i> Alunos
            </a>
            <a href="/workouts/library" class="nav-item <%= currentPage === '/workouts/library' ? 'active' : '' %>">
                <i class="fas fa-book"></i> Biblioteca
            </a>
            <a href="/trainer/financial" class="nav-item <%= currentPage === '/trainer/financial' ? 'active' : '' %>">
                <i class="fas fa-wallet"></i> Financeiro
            </a>
            
            <div class="menu-category">Configurações</div>
            <a href="/trainer/profile" class="nav-item <%= currentPage === '/trainer/profile' ? 'active' : '' %>">
                <i class="fas fa-id-card"></i> Perfil Profissional
            </a>

        <% } else if (user.role === 'admin' || user.role === 'superadmin') { %>
            <div class="menu-category">Admin</div>
            <a href="/admin/dashboard" class="nav-item <%= currentPage === '/admin/dashboard' ? 'active' : '' %>">
                <i class="fas fa-chart-pie"></i> Dashboard
            </a>
            <a href="/admin/clients" class="nav-item <%= currentPage === '/admin/clients' ? 'active' : '' %>">
                <i class="fas fa-users-cog"></i> Usuários
            </a>
            <a href="/admin/content" class="nav-item <%= currentPage === '/admin/content' ? 'active' : '' %>">
                <i class="fas fa-file-alt"></i> Conteúdo
            </a>
            <a href="/admin/plans" class="nav-item <%= currentPage === '/admin/plans' ? 'active' : '' %>">
                <i class="fas fa-tags"></i> Planos & Preços
            </a>
        <% } %>
    </nav>

    <div class="sidebar-footer">
        <div class="user-mini-profile">
            <div class="user-avatar-sm"><%= user.name.charAt(0) %></div>
            <div style="flex: 1; overflow: hidden;">
                <div style="font-size: 0.9rem; font-weight: 600; white-space: nowrap;"><%= user.name.split(' ')[0] %></div>
                <div style="font-size: 0.7rem; color: #666; text-transform: uppercase;"><%= user.role %></div>
            </div>
            <form action="/auth/logout" method="POST">
                <input type="hidden" name="_csrf" value="<%= typeof csrfToken !== 'undefined' ? csrfToken : '' %>">
                <button type="submit" class="btn btn-ghost" style="padding: 5px;"><i class="fas fa-sign-out-alt"></i></button>
            </form>
        </div>
    </div>
</aside>

<script>
    // Sidebar Toggle Logic
    const toggle = document.getElementById('sidebarToggle');
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    
    if(toggle) {
        toggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        });
        overlay.addEventListener('click', () => {
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
        });
    }
</script>
